import math
import numpy as np
import matplotlib.pyplot as plt
import sys
import os

#local imports

import calorimeter_160918.py as cal

def plotmany(header, data, ylabel = "signal [arb. units]"):
# list of lists [x1],[y1],[x2],etc.
    
    ncols = data.shape[1]-1

    # First plot
    ax1 = py.subplot(111)
    ax1.plot(x,y , "k")
    ax1.set_xlabel("x")

# Second plot
    ax2 = ax1.twiny()
    ax2.plot(x / c, y, "--r")
    ax2.set_xlabel("x'", color='r')
    for tl in ax2.get_xticklabels():
        tl.set_color('r')
        plt.figure(1)

    for i in range(ncols):
        plt.subplot(ncols,1,i+1)
        plt.plot(data[:,0], data[:,i+1],label=header[i+1])
#        plt.legend()
#        plt.title(header[i+1])
    plt.xlabel(header[0])
    plt.ylabel(ylabel)

    plt.show()


def main(filelist):
#    print "filelist :"
#    print filelist


#    header,data1 = read_calorimeter_datafiles(filelist)
    
    header,data1 = cal.read_own_datafile(filelist)

    plotmany(header,data1)
    



if __name__ == '__main__':
    
    args = []
#    print "args received"
#    print sys.argv

    try:
        if len(sys.argv) > 1:
            if sys.argv[1].find("-f")!= -1:
                filename = sys.argv[2]
                print "opeining file %s" % filname
                f = open(filename) 
                for line in f:
                    args.append(line.rstrip())
            else:
                args=sys.argv[1:]
        else:
            f = sys.stdin
            for line in f:
                args.append(line.rstrip())
    except:
        print 'usage: python calorimeter.py <files calorimeterdata.txt> \nor include -f to indicate a file contraing the file paths\nor "find anyfile.whatever | python calorimeter.py"'
        sys.exit(1)
#    print "args passed:"
    main(args)
